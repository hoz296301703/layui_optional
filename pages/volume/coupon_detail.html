<!DOCTYPE html>
<html>

<!--秒杀活动详情html-->

<head>
  <meta charset="UTF-8">
  <title></title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../static/css/font.css">
  <link rel="stylesheet" href="../../static/css/weadmin.css">
  <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
  <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  <style>
    /* 私有样式 */
    .layui-form-label {
      width: 70px;
    }

    /* .layui-table-cell {
      height: auto;
      line-height: 80px;
    } */
  </style>
</head>

<body>
  <div class="layui-collapse" lay-filter="test">
    <div class="layui-colla-item">
      <div class="weadmin-body">
        <form class="layui-form" id="manager_detail_form" lay-filter="example">
          <div class="layui-form-item">
            <div class="layui-inline">
              <label class="layui-form-label">流水号</label>
              <div class="layui-input-inline">
                <input type="text" name="serialNo" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">优惠券名称</label>
              <div class="layui-input-inline">
                <input type="text" name="couponName" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            
            <div class="layui-inline">
              <label class="layui-form-label">总数</label>
              <div class="layui-input-inline">
                <input type="text" name="couponNumber" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">已使用数量</label>
              <div class="layui-input-inline">
                <input type="text" name="quantityOfUse" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">剩余数量</label>
              <div class="layui-input-inline">
                <input type="text" name="quantityOfReceive" autocomplete="off" class="layui-input layui-disabled"
                  disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">条件</label>
              <div class="layui-input-inline">
                <select name="couponType" lay-verify="required" lay-search="" disabled>
                  <option value="" hidden>全部</option>
                  <option value="1">满减</option>
                  <option value="2">无门槛</option>
                </select>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">满减金额</label>
              <div class="layui-input-inline">
                <input type="text" name="satisfy" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">限领张数</label>
              <div class="layui-input-inline">
                <input type="text" name="receiveLimit" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">类型</label>
              <div class="layui-input-inline">
                <select name="useLimit" lay-verify="required" lay-search="" disabled>
                  <option value="" hidden>全部</option>
                  <option value="1">全平台</option>
                  <option value="2">店铺</option>
                  <option value="3">单个商品</option>
                </select>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">状态</label>
              <div class="layui-input-inline">
                <select name="flag" lay-verify="required" lay-search="" disabled>
                  <option value="" hidden>全部</option>
                  <option value="0">未开始</option>
                  <option value="1">已开始</option>
                  <option value="2">已过期</option>
                </select>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">开始时间</label>
              <div class="layui-input-inline">
                <input type="text" name="startTime" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">结束时间</label>
              <div class="layui-input-inline">
                <input type="text" name="endingTime" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">状态</label>
              <div class="layui-input-inline">
                <select name="status" lay-filter="aihao" class="layui-disabled" disabled>
                  <option value="">全部</option>
                  <option value="enable">正常</option>
                  <option value="disable">禁用</option>
                </select>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">金额回滚</label>
              <div class="layui-input-inline">
                <select name="flag" lay-verify="required" lay-search="" disabled>
                  <option value="" hidden>全部</option>
                  <option value="0">未处理</option>
                  <option value="1">已回滚</option>                  
                </select>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">创建人</label>
              <div class="layui-input-inline">
                <input type="text" name="createBy" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
            <div class="layui-inline">
              <label class="layui-form-label">创建日期</label>
              <div class="layui-input-inline">
                <input type="text" name="createDate" autocomplete="off" class="layui-input layui-disabled" disabled>
              </div>
            </div>
          </div>
      </div>
      </form>
    </div>
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 10px;">
      <legend>领取详情</legend>
    </fieldset>
    <div class="layui-form">
      <form id="form_sreach" class="layui-form">
        <table class="layui-hide" id="seckill_goods_list" lay-filter="seckill_goods_list" lay-size="sm"></table>
      </form>
      <script type="text/html" id="operateTpl_df">
        <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">明细</a>					
      </script>
    </div>
  </div>
  <!-- </div>
  </div> -->

  </div>
  </div>
  <script src="../../static/js/common.js" charset="utf-8"></script>
  <script src="../../lib/layui/layui.js" charset="utf-8"></script>
  <script src="../../static/js/dateUtils.js" charset="utf-8"></script>
  <script type="text/javascript">

    var g_data = '';// 全局数据变量
    //
    var head = '';
    var content = '';
    //获取传递数据
    function getParent_data(obj) {
      g_data = obj.data;
      layui.use(['table', 'jquery', 'form', 'tree', 'laydate'], function () {
        var table = layui.table,
          $ = layui.jquery,
          form = layui.form,
          tree = layui.tree,
          laydate = layui.laydate;
        // 动态设置表格高度
        table.render({
          elem: '#seckill_goods_list',
          cellMinWidth: 80,
          // height: 300,
          url: urlPrefix + 'silver-web-shop/userCoupon/findInfo',
          method: 'post',
          cols: [
            [
              {
                field: 'zizeng', width: 50, title: '序号', fixed: 'left', type: 'numbers'
              }, {
                field: 'careateDate', title: '领取日期', width: 170, templet: function (item) {
                  return G_format(item.createDate.time, "yyyy-MM-dd hh:mm:ss");
                }
              }, {
                //   field: 'goodsImage', title: '图片', width: 120, templet: function (item) {
                //     return '<div class="layer-photos-demo checkImg"  style="cursor:pointer;"><img layer-pid="" alt="' + g_imgSplit(item.goodsImage) + '"  src="' + g_imgSplit(item.goodsImage) + '" width="80px" height="80px"></div>';
                //   }
                // }, {
                field: 'memberName', title: '会员名称', width: 250
              }, {
                field: 'memberId', title: '会员编号', width: 180
              }, {
              //   field: 'price', title: '秒杀价格', width: 90
              // }, {
              //   field: 'count', title: '剩余库存', width: 90
              // }, {
              //   field: 'sellPrice', title: '原价', width: 90,
              // }, {
              //   field: 'sellCount', title: '总数', width: 90
              // }, {
                //   field: 'divAmount1', title: '金额', width: 100,
                // }, {
                field: 'flag', title: '状态', fixed: 'right', templet: function (item) {
                  var result = '';
                  // 标识：0-未使用、1-已使用，2-已过期
                  if (item.flag == '0') {
                    result = '未使用';
                  } else if (item.flag == '1') {
                    result = '已使用';
                  } else if (item.flag == '2') {
                    result = '已过期';
                  }
                  return result;
                }
                // }, {
                // field: 'operate', title: '操作', toolbar: '#operateTpl_df', fixed: 'right'
              }]
          ],
          event: true,
          page: true,
          response: {
            statusCode: 1 //重新规定成功的状态码为 200，table 组件默认为 0
          },
          request: {
            pageName: 'page', //页码的参数名称，默认：page
            limitName: 'size', //每页数据量的参数名，默认：limit
          },
          parseData: function (res) { //将原始数据解析成 table 组件所规定的数据
            return {
              "code": res.status, //解析接口状态
              "msg": res.msg, //解析提示文本
              "count": res.totalCount, //解析数据长度
              "data": res.datas //解析数据列表
            };
          },
          where: {
            couponNo: g_data.serialNo
          }
        });


        //监听工具条
        table.on('tool(seckill_goods_list)', function (obj) {
          var data = obj.data;
          if (obj.event === 'detail') {// 查看详情
            layer.open({
              type: 2,
              title: '分账明细',
              area: ['60%', '80%'],
              maxmin: true,
              content: './fz_details.html',
              btnAlign: 'c',
              btn: ['关闭'],
              success: function (layero, index) {
                // 获取子页面的iframe
                var iframe = window['layui-layer-iframe' + index];
                // 向子页面的全局函数child传参
                iframe.getParent_data(obj);
              },
              btn1: function (index) {
                layer.close(index);
              }
            });
          }
        });

        //图片浏览
        $('#form_sreach').on('click', '[lay-id="seckill_goods_list"] .checkImg', function (e) {
          console.info('图片预览');
          layer.photos({
            photos: {
              "data": [   //相册包含的图片，数组格式
                {
                  "alt": e.target.alt,
                  "src": e.target.src, //原图地址
                  "thumb": e.target.src //缩略图地址
                }
              ]
            }
          });
        });

        //监听折叠
        // element.on('collapse(test)', function (data) {
        //   //点击触发事件
        //   layer.msg('展开状态：' + data.show);
        // });

        //初始赋值
        form.val('example', {
          "serialNo": g_data.serialNo
          , "couponName": g_data.couponName
          , "quantityOfUse": g_data.quantityOfUse
          , "couponType": g_data.couponType
          , "satisfy": g_data.satisfy
          , "couponNumber": g_data.couponNumber
          , "receiveLimit": g_data.receiveLimit
          , "quantityOfReceive": g_data.quantityOfReceive
          , "useLimit": g_data.useLimit
          , "flag": g_data.flag
          , "rollback": g_data.rollback

          , "startTime": dateFormat(g_data.startTime)
          , "endingTime": dateFormat(g_data.endingTime)
          , "status": g_data.status
          , "createBy": g_data.createBy
          , "createDate": G_format(g_data.createDate.time, "yyyy-MM-dd hh:mm:ss")
        })

      });
    }
  </script>
</body>

</html>