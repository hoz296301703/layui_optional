<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title></title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../static/css/font.css">
  <link rel="stylesheet" href="../../static/css/weadmin.css">
  <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
  <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  <style>
    /* 私有样式 */
    .layui-form-label {
      width: 115px;
    }

    #ywxx .layui-form-label {
      width: 120px;
    }

    #merchantCost_update .layui-form-label,
    #merchantCost_add .layui-form-label {
      width: 90px;
    }

    #portRate_add .layui-form-label,
    #portRate_add .layui-form-label {
      width: 100px;

    }

    /* 基本数据 */
    #info .layui-form-item .layui-input-inline {
      width: 283px;
    }

    #merchantBank_add .layui-form-label {
      width: 100px;
    }
  </style>
</head>

<body>
  <div class="weadmin-body">
    <!-- 详情 -->
    <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
      <div class="weadmin-nav">
        <span class="layui-breadcrumb">
          <a>
            商户：<cite id="g-merchantName"></cite></a>
        </span>
      </div>
      <ul class="layui-tab-title">
        <li class="layui-this" id="info_tab">基本资料</li>
        <li id="findMerchantRecordDetail_tab">备案信息</li>
        <li id="getMerchantBusinessInfo_tab">企业资质</li>
        <li id="ywxx_tab">业务信息</li>
        <li id="merchantAllot_tab">物流信息</li>
        <li id="merchantCost_tab">计费信息</li>
        <li id="merchantBank_tab">银行卡信息</li>
        <li id="portRate_tab">口岸信息</li>
      </ul>
      <div class="layui-tab-content" style="height: 100px;">
        <!-- 基本信息 -->
        <div class="layui-tab-item layui-show">
          <form class="layui-form" lay-filter="info" id="info">
            <input type="hidden" name="merchantId">
            <input type="hidden" name="merchantName">
            <input type="hidden" name="merchantProfit">
            <div class="layui-form-item">
              <!-- <div class="layui-inline" >
                <label class="layui-form-label">
                  <span class="we-red">*</span>商户名称
                </label>
                <div class="layui-input-inline">
                  <input type="text" placeholder="请输入商户名称" name="merchantName" lay-verify="required " autocomplete="off"
                    disabled class="layui-input layui-disabled">
                </div>
              </div> -->
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>登录账号
                </label>
                <div class="layui-input-inline">
                  <input type="text" name="loginAccount" placeholder="请输入登录账号" lay-verify="required" autocomplete="off"
                    class="layui-input">
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">结算账号</label>
                <div class="layui-input-inline">
                  <input type="text" name="ysPartnerNo" placeholder="请输入银盛结算账号" autocomplete="off" class="layui-input">
                </div>
              </div>
            </div>

            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>简称
                </label>
                <div class="layui-input-inline">
                  <input type="text" name="companyName" placeholder="请输入商户简称" lay-verify="required" autocomplete="off"
                    class="layui-input">
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>法人姓名
                </label>
                <div class="layui-input-inline">
                  <input type="text" name="merchantIdCardName" placeholder="请输入法人姓名" lay-verify="required"
                    autocomplete="off" class="layui-input">
                </div>
              </div>
            </div>
            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>法人身份证号
                </label>
                <div class="layui-input-inline">
                  <input type="text" name="merchantIdCard" placeholder="请输入法人身份证号" lay-verify="required"
                    autocomplete="off" class="layui-input">
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>联系人电话
                </label>
                <div class="layui-input-inline">
                  <input type="text" id="L_phone" placeholder="请输入业务联系人电话" name="merchantPhone"
                    lay-verify="required|phone" autocomplete="" class="layui-input">
                </div>
              </div>
            </div>
            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>地址
                </label>
                <div class="layui-input-inline">
                  <input type="text" name="merchantAddress" placeholder="请输入地址" lay-verify="required" autocomplete="off"
                    class="layui-input">
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>商户等级
                </label>
                <div class="layui-input-inline">
                  <select name="merchantLevel" lay-verify="required" lay-filter="aihao">
                    <option value="0">普通商户</option>
                    <option value="1">vip商户</option>
                    <option value="100">白金商户</option>
                  </select>
                </div>
              </div>

            </div>

            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>状态
                </label>
                <div class="layui-input-inline">
                  <select name="merchantStatus" lay-verify="required" lay-filter="aihao">
                    <option value=""></option>
                    <option value="1">启用</option>
                    <option value="2">禁用</option>
                    <option value="3">审核</option>
                  </select>
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">电子邮箱</label>
                <div class="layui-input-inline">
                  <input type="text" name="merchantEmail" placeholder="请输入电子邮箱" autocomplete="off" class="layui-input">
                </div>
              </div>


            </div>
            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">QQ</label>
                <div class="layui-input-inline">
                  <input type="text" name="merchantQQ" placeholder="请输入QQ" autocomplete="off" class="layui-input">
                </div>
              </div>
            </div>
            <div class="layui-form-item" style="text-align: center;margin-top: 30px;">
              <button type="button" class="layui-btn" lay-filter="editMerhcnatInfo" lay-submit="">保存</button>
            </div>
          </form>
        </div>
        <!-- 备案信息 -->
        <div class="layui-tab-item">
          <div class="layui-form" id="record">
            <button class="layui-btn layui-btn-normal layui-btn-sm" lay-event="add" onclick="addTable();"><i
                class="layui-icon">&#xe61f;</i>添加</button>
            <table class="layui-table" id="findMerchantRecordDetail_table">
              <colgroup>
                <col width="140">
                <col width="210">
                <col width="210">
                <col width="210">
                <col width="210">
                <col>
              </colgroup>
              <thead>
                <tr>
                  <th>口岸<span class="we-red">(必填)</span></th>
                  <th>电商平台企业名称<span class="we-red">(必填)</span></th>
                  <th>电商平台企业编号<span class="we-red">(必填)</span></th>
                  <th>电商企业名称<span class="we-red">(必填)</span></th>
                  <th>电商企业编号<span class="we-red">(必填)</span></th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>

              </tbody>
            </table>
            <div class="layui-form-item" style="text-align: center;margin-top: 30px;">
              <button type="button" class="layui-btn" lay-filter="editMerchantRecordDetail" lay-submit="">保存</button>
            </div>
          </div>
        </div>
        <!-- 业务资料(图片) -->
        <div class="layui-tab-item" id="getMerchantBusinessInfo">
          <div class="layui-upload">
            <div class="layui-upload-list">
              <label class="layui-form-label" style="width: 150px;">企业营业执照：</label>
              <img width="100px" height="100px" style="border: 1px solid #ddd;" class="layui-upload-img"
                id="merchantBusinessLicenseLink">
              <p id="merchantBusinessLicenseLinkText" style="display: inline-block;"></p>
            </div>
          </div>
          <div class="layui-upload">
            <div class="layui-upload-list">
              <label class="layui-form-label" style="width: 150px;">特定行业经营许可证：</label>
              <img width="100px" height="100px" style="border: 1px solid #ddd;" class="layui-upload-img"
                id="merchantSpecificIndustryLicenseLink">
              <p id="merchantSpecificIndustryLicenseLinkText" style="display: inline-block;"></p>
            </div>
          </div>
        </div>
        <!-- 业务信息 -->
        <div class="layui-tab-item">
          <form class="layui-form" lay-filter="ywxx" id="ywxx">
            <input type="hidden" name="merchantId">
            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>支付类型
                </label>
                <div class="layui-input-inline">
                  <select name="businessType" lay-verify="required" lay-filter="aihao">
                    <option value=""></option>
                    <option value="online">线上支付</option>
                    <option value="offline">线下支付</option>
                    <option value="paid">第三方支付</option>
                  </select>
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>申报类型
                </label>
                <div class="layui-input-inline">
                  <select name="pushType" lay-verify="required" lay-filter="aihao">
                    <option value=""></option>
                    <option value="all">全部</option>
                    <option value="goodsRecord">商品备案</option>
                    <option value="orderRecord">订单申报</option>
                    <option value="paymentRecord">支付单申报</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>实名认证
                </label>
                <div class="layui-input-inline">
                  <select name="idCardVerifySwitch" lay-verify="required" lay-filter="aihao">
                    <option value=""></option>
                    <option value="on">开</option>
                    <option value="off">关</option>
                  </select>
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>订单返回类型
                </label>
                <div class="layui-input-inline">
                  <select name="thirdPartyReType" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="all">全部</option>
                    <option value="order">订单</option>
                    <option value="payment">支付单</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>订单代付
                </label>
                <div class="layui-input-inline">
                  <select name="memberPay" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="on">开</option>
                    <option value="off">关</option>
                  </select>
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>充值类型
                </label>
                <div class="layui-input-inline">
                  <select name="orderPayType" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="online">在线充值</option>
                    <option value="offline">线下转账</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>订单接入类型
                </label>
                <div class="layui-input-inline">
                  <select name="orderAccessType" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="api">线上接口</option>
                    <option value="excel">excel导入</option>
                  </select>
                </div>
              </div>
            </div>


            <div class="layui-form-item" style="text-align: center;margin-top: 30px;">
              <button type="button" class="layui-btn" lay-filter="merchantBusiness" lay-submit="">保存</button>
            </div>
          </form>
        </div>
        <!-- 物流信息 -->
        <div class="layui-tab-item">
          <ul id="merchantAllot"></ul>
          <div class="layui-form-item" style="text-align: center;margin-top: 30px;">
            <button type="button" class="layui-btn" lay-filter="merchantLogisticsSave" lay-submit="">保存</button>
          </div>
        </div>
        <!-- 计费信息 -->
        <div class="layui-tab-item">
          <button class="layui-btn layui-btn-normal layui-btn-sm" id="merchantCost_addBtn"><i
              class="layui-icon">&#xe61f;</i>添加</button>
          <table class="layui-hide" id="merchantCost" lay-filter="merchantCost"></table>
          <!-- 新增商户计费信息 -->
          <form class="layui-form" lay-filter="example" id="merchantCost_add"
            style="display: none;margin-top: 20px;width: 90%;">
            <div class="layui-form-item">
              <label class="layui-form-label">费用类型</label>
              <div class="layui-input-block">
                <select name="costType" lay-filter='costType' lay-verify="required">
                  <option value="">请选择</option>
                  <option value="goodsRecord">商品备案</option>
                  <option value="orderDeclare">订单申报</option>
                  <option value="paymentDeclare">支付单申报</option>
                  <option value="certification">实名认证</option>
                  <option value="paymentServiceCharge">支付服务费</option>
                </select>
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">计算类型</label>
              <div class="layui-input-block">
                <select id="tollType" name="tollType" lay-filter='tollType' lay-verify="required">
                  <option value="">请选择</option>
                  <option value="pen">每笔</option>
                  <option value="rate">比例</option>
                </select>
              </div>
            </div>
            <!-- 服务费 -->
            <div class="layui-form-item" style="display: none;" id="serviceCharge_pen">
              <label class="layui-form-label">服务费</label>
              <div class="layui-input-block" style="display: flex;align-items: center;">
                <input id="serviceCharge_penVal" lay-verify='number' type="number" autocomplete="off"
                  placeholder="请输入服务费" class="layui-input" style="width: 85%;margin-right:1%">元/笔
              </div>
            </div>
            <!-- 费率 -->
            <div class="layui-form-item" style="display: none;" id="serviceCharge_rate">
              <label class="layui-form-label">费率</label>
              <div class="layui-input-block" style="display: flex;align-items: center;">
                <input id="serviceCharge_rateVal" lay-verify='number' type="number" autocomplete="off"
                  placeholder="请输入费率" class="layui-input" style="width: 85%;margin-right:1%">%
              </div>
            </div>

            <div class="layui-form-item" id="backCoverFlag_li">
              <label class="layui-form-label">是否封底</label>
              <div class="layui-input-block">
                <select lay-filter='backCoverFlag_val' lay-verify="required" name="backCoverFlag">
                  <option value="">请选择</option>
                  <option value="false">否</option>
                  <option value="true">是</option>
                </select>
              </div>
            </div>

            <div class="layui-form-item" style="display: none;" id="backCoverFee_li">
              <label class="layui-form-label">封底服务费</label>
              <div class="layui-input-block" style="display: flex;align-items: center;">
                <input lay-verify='number' type="number" id="serviceCharge_rateVal" name="backCoverFee"
                  autocomplete="off" placeholder="请输入封底服务费" class="layui-input" style="width: 85%;margin-right:1%">元
              </div>
            </div>

            <div class="layui-form-item" style="text-align: center;">
              <button type="button" class="layui-btn layui-btn-sm" lay-filter="add_merchantCost"
                lay-submit="">保存</button>
              <button type="button" class="layui-btn layui-btn-sm layui-btn-primary close_add">关闭</button>

            </div>

          </form>
          <!-- 修改商户计费信息 -->
          <form class="layui-form" lay-filter="merchantCost_update" id="merchantCost_update"
            style="display: none;margin-top: 20px;width: 90%;">
            <input type="hidden" name="serialNo">
            <div class="layui-form-item">
              <label class="layui-form-label">费用类型</label>
              <div class="layui-input-block">
                <select name="costType" lay-filter='costType' lay-verify="required" disabled class="layui-disabled">
                  <option value="">请选择</option>
                  <option value="goodsRecord">商品备案</option>
                  <option value="orderDeclare">订单申报</option>
                  <option value="paymentDeclare">支付单申报</option>
                  <option value="certification">实名认证</option>
                  <option value="paymentServiceCharge">支付服务费</option>
                </select>
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">计算类型</label>
              <div class="layui-input-block">
                <select id="tollType_update" name="tollType" lay-filter='tollType_update'
                  lay-verify="required"></select>
              </div>
            </div>
            <!-- 服务费 -->
            <div class="layui-form-item" style="display: none;" id="serviceCharge_pen_update">
              <label class="layui-form-label">服务费</label>
              <div class="layui-input-block" style="display: flex;align-items: center;">
                <input id="serviceCharge_penVal_update" type="number" autocomplete="off" placeholder="请输入服务费"
                  class="layui-input" style="width: 85%;margin-right:1%">元/笔
              </div>
            </div>
            <!-- 费率 -->
            <div class="layui-form-item" style="display: none;" id="serviceCharge_rate_update">
              <label class="layui-form-label">费率</label>
              <div class="layui-input-block" style="display: flex;align-items: center;">
                <input id="serviceCharge_rateVal_update" type="number" autocomplete="off" placeholder="请输入费率"
                  class="layui-input" style="width: 85%;margin-right:1%">%
              </div>
            </div>

            <div class="layui-form-item" id="backCoverFlag_li_update">
              <label class="layui-form-label">是否封底</label>
              <div class="layui-input-block">
                <select lay-filter='backCoverFlag_val_update' lay-verify="required" name="backCoverFlag">
                  <option value="">请选择</option>
                  <option value="false">否</option>
                  <option value="true">是</option>
                </select>
              </div>
            </div>

            <div class="layui-form-item" style="display: none;" id="backCoverFee_li_update">
              <label class="layui-form-label">封底服务费</label>
              <div class="layui-input-block" style="display: flex;align-items: center;">
                <input lay-verify='number' type="number" id="backCoverFlag_val_update" name="backCoverFee"
                  autocomplete="off" placeholder="请输入封底服务费" class="layui-input" style="width: 85%;margin-right:1%">元
              </div>
            </div>
            <div class="layui-form-item" style="text-align: center;">
              <button type="button" class="layui-btn layui-btn-sm" lay-filter="update_merchantCost"
                lay-submit="">保存</button>
              <button type="button" class="layui-btn layui-btn-sm layui-btn-primary close_add">关闭</button>

            </div>
          </form>
        </div>
        <!-- 计费信息操作按钮 -->
        <script type="text/html" id="merchantCostTpl">
          <a class="layui-btn layui-btn-xs" lay-event="edit">修改</a>
        </script>
        <!-- 银行卡信息 -->
        <div class="layui-tab-item">
          <button class="layui-btn layui-btn-normal layui-btn-sm" id="merchantBank_addBtn"><i
              class="layui-icon">&#xe61f;</i>添加</button>
          <table class="layui-hide" id="merchantBank" lay-filter="merchantBank"></table>
          <!-- 新增商户银行卡信息 -->
          <form class="layui-form" lay-filter="merchantBank_add" id="merchantBank_add"
            style="display: none;width: 90%; margin: 20px auto;">
            <div class="layui-form-item">
              <label class="layui-form-label">银行卡号</label>
              <div class="layui-input-block">
                <input type="text" name="bankAccountNo" autocomplete="off" placeholder="请输入银行卡号" class="layui-input"
                  lay-verify="required">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">预留手机号</label>
              <div class="layui-input-block">
                <input type="tel" name="reservedTel" lay-verify="required|phone" autocomplete="off"
                  placeholder="请输入预留手机号" class="layui-input">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">开户行名称</label>
              <div class="layui-input-block">
                <input type="text" name="bankName" autocomplete="off" placeholder="如：工商银行" class="layui-input"
                  lay-verify="required">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">银行卡账户名称</label>
              <div class="layui-input-block">
                <input type="text" name="bankAccountName" autocomplete="off" placeholder="银行卡主" class="layui-input"
                  lay-verify="required">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">省/市</label>
              <div class="layui-input-inline">
                <select lay-verify="required" name="bankProvince" lay-filter="province" id="province"></select>
              </div>
              <div class="layui-input-inline">
                <select lay-verify="required" name="bankCity" id="city" lay-filter="city"></select>
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">银行卡账户类型</label>
              <div class="layui-input-block">
                <select name="bankAccountType" lay-filter='tollType' lay-verify="required">
                  <option value="">请选择</option>
                  <option value="personal">对私</option>
                  <option value="corporate">对公</option>
                </select>
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">银行卡类别</label>
              <div class="layui-input-block">
                <select name="bankCardType" lay-filter='tollType' lay-verify="required">
                  <option value="">请选择</option>
                  <option value="debit">借记卡</option>
                  <option value="credit">信用卡</option>
                  <option value="unit">单位结算卡</option>
                </select>
              </div>
            </div>
            <div class="layui-form-item">
              <label class="layui-form-label">默认使用</label>
              <div class="layui-input-block">
                <input type="checkbox" name="defaultFlag" lay-skin="switch" lay-text="是|否">
              </div>
            </div>

            <div class="layui-form-item" style="text-align: center;">
              <button type="button" class="layui-btn layui-btn-sm" lay-filter="add_merchantBankBtn"
                lay-submit="">保存</button>
              <button type="button" class="layui-btn layui-btn-sm layui-btn-primary close_add">关闭</button>

            </div>

          </form>
          <!-- 修改商户银行卡信息 -->
          <form class="layui-form" lay-filter="merchantBank_update" id="merchantBank_update"
            style="display: none;width: 90%; margin: 20px auto;">
            <input type="hidden" name="merchantId">
            <input type="hidden" name="serialNo">
            <div class="layui-form-item">
              <label class="layui-form-label">银行卡号</label>
              <div class="layui-input-block">
                <input type="text" name="bankAccountNo" autocomplete="off" placeholder="请输入银行卡号" class="layui-input"
                  lay-verify="required">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">预留手机号</label>
              <div class="layui-input-block">
                <input type="tel" name="reservedTel" lay-verify="required|phone" autocomplete="off"
                  placeholder="请输入预留手机号" class="layui-input">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">开户行名称</label>
              <div class="layui-input-block">
                <input type="text" name="bankName" autocomplete="off" placeholder="如：工商银行" class="layui-input"
                  lay-verify="required">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">银行卡账户名称</label>
              <div class="layui-input-block">
                <input type="text" name="bankAccountName" autocomplete="off" placeholder="银行卡主" class="layui-input"
                  lay-verify="required">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">省/市</label>
              <div class="layui-input-inline">
                <select lay-verify="required" name="bankProvince" lay-filter="province_update"
                  id="province_update"></select>
              </div>
              <div class="layui-input-inline">
                <select lay-verify="required" name="bankCity" id="city_update" lay-filter="city_update"></select>
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">银行卡账户类型</label>
              <div class="layui-input-block">
                <select name="bankAccountType" lay-filter='tollType' lay-verify="required">
                  <option value="">请选择</option>
                  <option value="personal">对私</option>
                  <option value="corporate">对公</option>
                </select>
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">银行卡类别</label>
              <div class="layui-input-block">
                <select name="bankCardType" lay-filter='tollType' lay-verify="required">
                  <option value="">请选择</option>
                  <option value="debit">借记卡</option>
                  <option value="credit">信用卡</option>
                  <option value="unit">单位结算卡</option>
                </select>
              </div>
            </div>
            <div class="layui-form-item">
              <label class="layui-form-label">默认使用</label>
              <div class="layui-input-block">
                <input type="checkbox" name="defaultFlag" lay-skin="switch" lay-text="是|否">
              </div>
            </div>

            <div class="layui-form-item" style="text-align: center;">
              <button type="button" class="layui-btn layui-btn-sm" lay-filter="update_merchantBankBtn"
                lay-submit="">保存</button>
              <button type="button" class="layui-btn layui-btn-sm layui-btn-primary close_add">关闭</button>

            </div>

          </form>
        </div>
        <!-- 银行卡信息操作按钮 -->
        <script type="text/html" id="merchantBankTpl">
          <a class="layui-btn layui-btn-xs" lay-event="edit">修改</a>
        </script>
        <!-- 口岸信息 -->
        <div class="layui-tab-item">
          <button class="layui-btn layui-btn-normal layui-btn-sm" id="portRate_addBtn"><i
              class="layui-icon">&#xe61f;</i>添加</button>
          <table class="layui-hide" id="portRate" lay-filter="portRate"></table>
          <!-- 新增口岸信息 -->
          <form class="layui-form" lay-filter="portRate_add" id="portRate_add"
            style="display: none;width: 90%; margin: 20px auto;">

            <div class="layui-form-item">
              <label class="layui-form-label">
                <span class="we-red">*</span>海关
              </label>
              <div class="layui-input-inline" style="width:500px;">
                <select name="ciqOrg" lay-verify="required" lay-filter="aihao">

                </select>
              </div>
            </div>

            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>类型
                </label>
                <div class="layui-input-inline">
                  <select name="type" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="goodsRecord">商品备案</option>
                    <option value="orderRecord">订单申报</option>
                    <option value="paymentRecord">支付单备案</option>
                  </select>
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>状态
                </label>
                <div class="layui-input-inline">
                  <select name="status" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="1">正常</option>
                    <option value="2">禁用</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="layui-form-item" style="text-align: center;margin-top: 30px;">
              <button type="button" class="layui-btn" lay-filter="portRate_updateBtn" lay-submit="">保存</button>
            </div>

          </form>
          <!-- 修改口岸信息 -->
          <form class="layui-form" lay-filter="portRate_update" id="portRate_update"
            style="display: none;width: 90%; margin: 20px auto;">
            <input type="hidden" name="merchantId">
            <input type="hidden" name="merchantFeeId">
            <input type="hidden" name="tollType">
            <input type="hidden" name="penFees">
            <div class="layui-form-item">
              <label class="layui-form-label">
                <span class="we-red">*</span>海关
              </label>
              <div class="layui-input-inline" style="width:500px;">
                <select name="ciqOrg" lay-verify="required" lay-filter="aihao">

                </select>
              </div>
            </div>

            <div class="layui-form-item">
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>类型
                </label>
                <div class="layui-input-inline">
                  <select name="type" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="goodsRecord">商品备案</option>
                    <option value="orderRecord">订单申报</option>
                    <option value="paymentRecord">支付单备案</option>
                  </select>
                </div>
              </div>
              <div class="layui-inline">
                <label class="layui-form-label">
                  <span class="we-red">*</span>状态
                </label>
                <div class="layui-input-inline">
                  <select name="status" lay-verify="required" lay-filter="aihao">
                    <option value="">请选择</option>
                    <option value="1">正常</option>
                    <option value="2">禁用</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="layui-form-item" style="text-align: center;">
              <button type="button" class="layui-btn layui-btn-sm" lay-filter="update_portRateBtn"
                lay-submit="">保存</button>
              <!-- <button type="button" class="layui-btn layui-btn-sm layui-btn-primary close_add">关闭</button> -->

            </div>

          </form>
        </div>
      </div>
    </div>

  </div>
  <script src="../../static/js/common.js" charset="utf-8"></script>
  <script src="../../lib/layui/layui.js" charset="utf-8"></script>
  <script type="text/javascript">
    layui.extend({
      admin: '{/}../../static/js/admin'
    });
    var g_data = '';// 全局数据变量
    function getParent_data(obj) {
      g_data = obj.data;

    }
    layui.use(['tree', 'form', 'jquery', 'util', 'admin', 'layer', 'upload', 'table'], function () {
      var form = layui.form,
        $ = layui.jquery,
        util = layui.util,
        admin = layui.admin,
        table = layui.table,
        tree = layui.tree,
        upload = layui.upload,
        layer = layui.layer;


      //自定义验证规则
      form.verify({
        pass: [/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,20}$/, '密码由6-20字母和数字组成'],
        repass: function (value) {
          if ($('#L_pass').val() != $('#L_repass').val()) {
            return '两次密码不一致';
          }
        }
      });
      $('#g-merchantName').html(g_data.merchantName)
      /** 基本信息 **/
      // 管理员查看商户基本信息
      var _findMerchantDetail = function () {
        $.ajax({
          url: urlPrefix + "silver-web-shop/manager/getMerchantInfo",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: { merchantId: g_data.merchantId },
          success: function (response) {
            if (response.status == 1) {
              var datas = response.datas[0];
              //表单初始赋值
              form.val('info', {
                "merchantName": datas.merchantName
                , "merchantId": datas.merchantId
                , "loginAccount": datas.loginAccount
                , "companyName": datas.companyName
                , "merchantIdCardName": datas.merchantIdCardName
                , "merchantIdCard": datas.merchantIdCard
                , "merchantPhone": datas.merchantPhone
                , "merchantAddress": datas.merchantAddress
                , "merchantLevel": datas.merchantLevel
                , "merchantStatus": datas.merchantStatus
                , "merchantProfit": 0// 默认为0
                , "merchantEmail": datas.merchantEmail
                , "merchantQQ": datas.merchantQQ
                , "ysPartnerNo": datas.ysPartnerNo
              })
            }
          }
        });
      };
      _findMerchantDetail()
      $('#info_tab').click(function () {
        _findMerchantDetail()
      })
      //修改商户基本信息
      form.on('submit(editMerhcnatInfo)', function (data) {
        layer.load(2);
        $.ajax({
          url: urlPrefix + "silver-web-shop/manager/editMerhcnatInfo",
          // type: "POST",
          method: 'post',
          dataType: 'JSON',
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            layer.closeAll("loading");
            if (response.status == 1) {
              layer.msg('修改成功！');
              setTimeout(function () {
                _findMerchantDetail();
              }, 1000);
            } else {
              layer.close();
              layer.alert(response.msg);
            }
          }
        });
      });

      /** 备案信息 **/
      // 查看备案信息
      var _findMerchantRecordDetail = function (data) {
        $.ajax({
          url: urlPrefix + "silver-web-shop/manager/findMerchantRecordDetail",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: { merchantId: g_data.merchantId },
          success: function (response) {
            if (response.status == 1) {
              // 修改详情
              var divStr = "";// 表格字符串
              var arr = [];
              $.each(response.datas, function (i, item) {
                var dz = ''
                var zj = ''
                if (item.customsPort == 1) {
                  dz = 'selected';
                } else if (item.customsPort == 2) {
                  zj = 'selected';
                }
                divStr += `<tr data-id="${item.id}">
                  <td>
                      <div class="layui-input-inline"><select name="eport" lay-verify="required"  class="valid">
                        <option value="">请选择</option>
                        <option value="1" ${dz}>电子口岸</option>
                        <option value="2" ${zj}>智检</option>
                      </select></div>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  value="${item.ebpEntName}" name="ebpEntName" class="layui-input"></div>
                  </td>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  value="${item.ebpEntNo}" name="ebpEntNo" class="layui-input"></div>
                  </td>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  value="${item.ebEntName}" name="ebEntName" class="layui-input"></div>
                  </td>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  value="${item.ebEntNo}" name="ebEntNo" class="layui-input"></div>
                  </td>
                  <td>
                      <a class="layui-btn layui-btn-danger layui-btn-xs delete">删除</a>
                  </td>
                </tr>`

              });
              $('#findMerchantRecordDetail_table tbody').html(divStr);
              form.render('select');
            }
          }
        });
      };
      $('#findMerchantRecordDetail_tab').click(function () {
        _findMerchantRecordDetail();
      })
      // 动态添加表格
      window.addTable = function () {
        var len = $("#findMerchantRecordDetail_table tbody").find('tr').length;
        var tableHtml = `<tr>
                  <td>
                      <div class="layui-input-inline"><select name="eport" lay-verify="required"  class="valid">
                        <option value="">请选择</option>
                        <option value="1">电子口岸</option>
                        <option value="2">智检</option>
                      </select></div>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  name="ebpEntName" class="layui-input"></div>
                  </td>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  name="ebpEntNo" class="layui-input"></div>
                  </td>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  name="ebEntName" class="layui-input"></div>
                  </td>
                  <td>
                    <div class="layui-input-inline"><input type="text" lay-verify="required"  name="ebEntNo" class="layui-input"></div>
                  </td>
                  <td>
                      <a class="layui-btn layui-btn-danger layui-btn-xs deleteTr">删除</a>
                  </td>
                </tr>`
        $("#findMerchantRecordDetail_table tbody").append(tableHtml); //在表头之后添加空白行
        form.render('select');
      }
      // 删除行
      $("#findMerchantRecordDetail_table").on('click', '.deleteTr', function () {
        $(this).parents('tr').remove();
      })
      // 删除行(调接口删除)
      $("#findMerchantRecordDetail_table").on('click', '.delete', function () {
        var _this = this;
        layer.alert("确定要删除？", {
          time: 0, //不自动关闭
          btn: ["保存", "关闭"],
          yes: function (index) {
            $.ajax({
              url: urlPrefix + "silver-web-shop/manager/managerDeleteMerchantRecordInfo",
              type: "POST",
              xhrFields: {
                withCredentials: true
              },
              data: { id: $(_this).parents('tr').attr("data-id") },
              success: function (response) {
                if (response.status == 1) {
                  layer.msg("删除成功！");
                  _findMerchantRecordDetail();
                } else {
                  layer.close();
                  layer.alert(response.msg);
                }
              }
            });
          }
        });
      })
      //保存修改备案信息
      form.on('submit(editMerchantRecordDetail)', function () {

        var editMerchantRecordDetailArr = [];
        $.each(
          $("#findMerchantRecordDetail_table tbody tr"),
          function (i, obj) {
            var id = "";
            if (!isEmpty($(obj).attr("data-id"))) {
              id = $(obj).attr("data-id");
            }
            editMerchantRecordDetailArr.push({
              customsPort: $(obj).find('[name=eport]').val(),
              ebpEntName: $(obj).find('[name=ebpEntName]').val(),
              ebpEntNo: $(obj).find('[name=ebpEntNo]').val(),
              ebEntName: $(obj).find('[name=ebEntName]').val(),
              ebEntNo: $(obj).find('[name=ebEntNo]').val(),
              id: id
            });
          }
        );
        var editMerchantRecordDetailData = {// 传参对象
          merchantId: g_data.merchantId,
          merchantRecordInfo: JSON.stringify(editMerchantRecordDetailArr)
        };

        layer.load(2);
        $.ajax({
          url: urlPrefix + "silver-web-shop/manager/editMerchantRecordDetail",
          type: "POST",
          dataType: 'JSON',
          xhrFields: {
            withCredentials: true
          },
          data: editMerchantRecordDetailData,
          success: function (response) {
            layer.closeAll("loading");
            if (response.status == 1) {
              layer.msg('修改成功！');
              setTimeout(function () {
                _findMerchantRecordDetail();
              }, 1000);
            } else {
              layer.alert(response.msg, function () {
                layer.closeAll();
                _findMerchantRecordDetail();
              });

            }
          }
        });
      });

      /** 企业资质 **/
      // 管理员查看商户证件图
      var _getMerchantBusinessInfo = function () {
        $.ajax({
          url: urlPrefix + "silver-web-shop/manager/getMerchantBusinessInfo",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: { merchantId: g_data.merchantId },
          success: function (response) {
            if (response.status == 1) {
              var datas = response.datas[0];
              // 企业营业执照
              if (!isEmpty(datas.merchantBusinessLicenseLink)) {// 判断是否有上传的图片
                $("#merchantBusinessLicenseLink").attr("src", merchantImgPrefix + datas.merchantId + "/" + datas.merchantBusinessLicenseLink
                ); // 渲染图片
              } else {
                $("#merchantBusinessLicenseLink").attr("src", "../../static/images/bgImg.jpg"); // 渲染默认图片
              }
              // 特定行业经营许可证
              if (!isEmpty(datas.merchantSpecificIndustryLicenseLink)) {
                $("#merchantSpecificIndustryLicenseLink").attr(
                  "src", merchantImgPrefix + datas.merchantId + "/" + datas.merchantSpecificIndustryLicenseLink
                ); // 渲染图片
              } else {
                $("#merchantSpecificIndustryLicenseLink").attr("src", "../../static/images/bgImg.jpg"); // 渲染默认图片
              }
            } else {
              alert(response.msg);
            }
          }
        });
      };
      $('#getMerchantBusinessInfo_tab').click(function () {
        _getMerchantBusinessInfo();
      })

      //企业营业执照图片上传
      var uploadMerchantBusinessLicenseLink = upload.render({
        elem: '#merchantBusinessLicenseLink'
        , url: urlPrefix + 'silver-web-shop/manager/editMerhcnatBusinessInfo'
        // ,method: ''  //可选项。HTTP类型，默认post
        , acceptMime: 'image/*'
        , size: 1024 * 2 //限定大小
        , data: { merchantBusinessLicenseLink: '222' } //可选项。额外的参数，如：{id: 123, abc: 'xxx'}
        , before: function (obj) {
          //预读本地文件示例，不支持ie8
          obj.preview(function (index, file, result) {
            $('#merchantBusinessLicenseLink').attr('src', result); //图片链接（base64）
          });
        }
        , done: function (res) {
          //如果上传失败
          if (res.code > 0) {
            return layer.msg('上传失败');
          }
          //上传成功
        }
        , error: function () {
          //演示失败状态，并实现重传
          var p = $('#merchantBusinessLicenseLinkText');
          p.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
          p.find('.demo-reload').on('click', function () {
            uploadMerchantBusinessLicenseLink.upload();
          });
        }
      });
      //特定行业经营许可证
      var uploadMerchantBusinessLicenseLink = upload.render({
        elem: '#merchantSpecificIndustryLicenseLink'
        , url: urlPrefix + 'silver-web-shop/manager/editMerhcnatBusinessInfo'
        // ,method: ''  //可选项。HTTP类型，默认post
        , acceptMime: 'image/*'
        , size: 1024 * 2 //限定大小
        , data: { merchantBusinessLicenseLink: '222' } //可选项。额外的参数，如：{id: 123, abc: 'xxx'}
        , before: function (obj) {
          //预读本地文件示例，不支持ie8
          obj.preview(function (index, file, result) {
            $('#merchantSpecificIndustryLicenseLink').attr('src', result); //图片链接（base64）
          });
        }
        , done: function (res) {
          //如果上传失败
          if (res.code > 0) {
            return layer.msg('上传失败');
          }
          //上传成功
        }
        , error: function () {
          //演示失败状态，并实现重传
          var p = $('#merchantSpecificIndustryLicenseLinkText');
          p.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
          p.find('.demo-reload').on('click', function () {
            uploadMerchantBusinessLicenseLink.upload();
          });
        }
      });

      /** 业务信息 **/
      // 管理员查看商户业务信息
      var _merchantBusiness = function () {
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantBusiness/getInfo",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: {
            merchantId: g_data.merchantId,
            page: 0,
            size: 0
          },
          success: function (response) {
            if (response.status == 1) {
              var datas = response.datas[0];
              //表单初始赋值
              form.val('ywxx', {
                "merchantId": datas.merchantId
                , "merchantName": datas.merchantName
                , "businessType": datas.businessType
                , "pushType": datas.pushType
                , "idCardVerifySwitch": datas.idCardVerifySwitch
                , "thirdPartyReType": datas.thirdPartyReType
                , "memberPay": datas.memberPay
                , "orderPayType": datas.orderPayType
                , "orderAccessType": datas.orderAccessType
              })
              $("#ywxx").attr("data-id", 2); // 修改标识
            } else {
              // 未添加
              $("#ywxx").attr("data-id", 1); // 新增标识
            }
          },
          error: function () {

          }
        });
      };
      $('#ywxx_tab').click(function () {
        _merchantBusiness();
      })
      //保存修改业务资料
      form.on('submit(merchantBusiness)', function (data) {
        var url = "silver-web-shop/merchantBusiness/updateInfo"; // 修改接口
        if ($("#ywxx").attr("data-id") == 1) {
          url = "silver-web-shop/merchantBusiness/addInfo";// 新增
          data.field.merchantId = g_data.merchantId;
        }

        layer.load(2);
        $.ajax({
          url: urlPrefix + url,
          type: "POST",
          dataType: 'JSON',
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            layer.closeAll("loading");
            if (response.status == 1) {
              layer.msg('保存成功！');
              setTimeout(function () {
                _merchantBusiness();
              }, 1000);
            } else {
              layer.alert(response.msg, function () {
                layer.closeAll();
                _merchantBusiness();
              });

            }
          }
        });
      });

      //** 物流信息  **//
      var _logistics = function () {
        var groupNameData = {}; // 数据处理成map数据
        $.ajax({
          url: urlPrefix + "silver-web-shop/logistics/getInfo",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: { page: 0, size: 0 },
          success: function (response) {
            var datas = response.datas;
            var len = datas.length;
            for (var i = 0; i < len; i++) {
              if (
                groupNameData.hasOwnProperty(
                  datas[i].logisticsCompanyCode +
                  "_" +
                  datas[i].logisticsCompanyName
                )
              ) {
                groupNameData[
                  datas[i].logisticsCompanyCode +
                  "_" +
                  datas[i].logisticsCompanyName
                ].push(datas[i]);
              } else {
                groupNameData[
                  datas[i].logisticsCompanyCode +
                  "_" +
                  datas[i].logisticsCompanyName
                ] = [];
                groupNameData[
                  datas[i].logisticsCompanyCode +
                  "_" +
                  datas[i].logisticsCompanyName
                ].push(datas[i]);
              }
            }


            if (response.status == 1) {
              //** 请求商户物流信息 start  **/
              $.ajax({
                url: urlPrefix + "silver-web-shop/merchantLogistics/getInfo",
                type: "POST",
                xhrFields: {
                  withCredentials: true
                },
                data: {
                  merchantId: g_data.merchantId,
                },
                success: function (response2) {
                  var jsonArr = []; // 树结构数据
                  if (response2.status == 1) {
                    var ii = 0;
                    $.each(groupNameData, function (key, val1) {
                      // 遍历处理好的map数据

                      // 遍历物流信息
                      jsonArr.push({ title: key, children: [] }); // 为每个对象里面创建一个新对象
                      var jj = 0;
                      $.each(val1, function (j, val2) {
                        var checked = false; // 默认状态
                        for (
                          var index = 0;
                          index < response2.datas.length;
                          index++
                        ) {
                          // 遍历商户已有物流

                          if (
                            key.split("_")[0] ==
                            response2.datas[index].logisticsCompanyCode
                          ) {
                            // 只能当前物流相同，才能进入赋值
                            if (
                              val2.expressCompanyCode ==
                              response2.datas[index].expressCompanyCode
                            ) {
                              // 判断当前树结构的流水号和商户的物流的流水号一致

                              if (response2.datas[index].status == "enable") {
                                // 判断商户是否有开这个物流
                                // jsonArr[ii].checked = true;
                                checked = true;
                              }
                            }
                          }
                        }
                        jsonArr[ii].children.push({
                          title:
                            val2.expressCompanyCode +
                            "_" +
                            val2.expressCompanyName,
                          id: val2.serialNo,
                          checked: checked,
                          checkboxValue: val2.serialNo
                        });
                        jj++;
                      });
                      ii++;
                    });
                  } else {
                    var ii = 0;
                    $.each(groupNameData, function (key, val1) {
                      jsonArr.push({ title: key, children: [] });
                      var jj = 0;
                      $.each(val1, function (j, val2) {
                        var checked = false;
                        if (val2.serialNo == "true") {
                          // jsonArr[j].checked = true;
                          checked = true;
                        }
                        jsonArr[ii].children.push({
                          title:
                            val2.expressCompanyCode +
                            "_" +
                            val2.expressCompanyName,
                          id: val2.serialNo,
                          checked: checked,
                          checkboxValue: val2.serialNo
                        });
                        jj++;
                      });
                      ii++;
                    });
                  }
                  // 渲染数据
                  tree.render({
                    elem: '#merchantAllot'
                    , data: jsonArr
                    , check: "checkbox" //勾选风格
                    , showCheckbox: true  //是否显示复选框
                    , id: 'demoId'
                    , checkboxName: "allot" //复选框的name属性值
                    , checkboxStyle: "" //设置复选框的样式，必须为字符串，css样式怎么写就怎么写
                    // , isJump: true //是否允许点击节点时弹出新窗口跳转
                    , click: function (obj) {

                    }
                  });
                },
                error: function () {
                  layer.alert(response2.msg);
                }
              });
              //** 请求商户物流信息 end  **/
            } else {
              layer.alert(response.msg);
            }
          }
        });
      }
      $('#merchantAllot_tab').click(function () {
        _logistics();
      })
      //保存修改业务资料
      form.on('submit(merchantLogisticsSave)', function () {
        layer.load(2);
        var arr = [];
        $.each($("#merchantAllot").find('.layui-form input[type="checkbox"]'), function (i, item) {
          if (item.checked && item.value != "undefined") {
            arr.push(item.value);
          }
        })
        var data = {
          merchantId: g_data.merchantId,
          serialNoPack: JSON.stringify(arr)
        };
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantLogistics/updateInfo",
          type: "POST",
          dataType: 'JSON',
          xhrFields: {
            withCredentials: true
          },
          data: data,
          success: function (response) {
            layer.closeAll("loading");
            if (response.status == 1) {
              layer.msg('保存成功！');
              setTimeout(function () {
                _logistics();
              }, 1000);
            } else {
              layer.alert(response.msg, function () {
                layer.closeAll();
                _logistics();
              });

            }
          }
        });
      });

      //** 计费信息 **//
      $('#merchantCost_tab').click(function () {
        table.render({
          elem: '#merchantCost',
          cellMinWidth: 80,
          // height: tableHeight,
          url: urlPrefix + 'silver-web-shop/merchantCost/getInfo',
          method: 'post',
          cols: [
            [{
              field: 'costType', width: 100, title: '费用类型', templet: function (item) {
                if (item.costType == 'goodsRecord') {
                  return '商品备案';
                } else if (item.costType == 'orderDeclare') {
                  return '订单申报';
                } else if (item.costType == 'paymentDeclare') {
                  return '支付单申报';
                } else if (item.costType == 'certification') {
                  return '实名认证';
                } else if (item.costType == 'paymentServiceCharge') {
                  return '支付服务费';
                }
              }
            }, {
              field: 'tollType', width: 100, title: '计算类型', templet: function (item) {
                if (item.tollType == 'pen') {
                  return '每笔';
                } else if (item.tollType == 'rate') {
                  return '比例';
                }
              }
            }, {
              field: 'serviceCharge', width: 100, title: '费率', templet: function (item) {
                if (item.tollType == 'pen') {
                  return item.serviceCharge + "元/笔";
                } else if (item.tollType == 'rate') {
                  return accMul(item.serviceCharge, 100) + "%";
                }
              }
            }, {
              field: 'backCoverFlag', width: 100, title: '是否封底', templet: function (item) {
                if (item.backCoverFlag == 'false') {
                  return '否';
                } else if (item.backCoverFlag == 'true') {
                  return '是';
                } else if (item.costType == 'paymentServiceCharge') {
                  return '-';
                } else {
                  return '否';
                }
              }
            }, {
              field: 'backCoverFee', width: 100, title: '封底服务费', templet: function (item) {
                if (item.backCoverFlag == 'false') {
                  return '-';
                } else if (item.backCoverFlag == 'true') {
                  return item.backCoverFee + "元";
                } else if (item.costType == 'paymentServiceCharge') {
                  return '-';
                } else {
                  return '-';
                }
              }
            }, {
              field: 'operate', title: '操作', toolbar: '#merchantCostTpl', fixed: 'right'
            }]
          ],
          event: true,
          response: {
            statusCode: 1 //重新规定成功的状态码为 200，table 组件默认为 0
          },
          where: {
            page: 0,
            size: 0,
            merchantId: g_data.merchantId
          },
          request: {
            pageName: 'page', //页码的参数名称，默认：page
            limitName: 'size' //每页数据量的参数名，默认：limit
          },
          parseData: function (res) { //将原始数据解析成 table 组件所规定的数据
            return {
              "code": res.status, //解析接口状态
              "msg": res.msg, //解析提示文本
              "count": res.totalCount, //解析数据长度
              "data": res.datas //解析数据列表
            };
          },
          done: function (res, curr, count) { }
        });
      })
      // 重载计费信息表格
      var _reload = function () {
        table.reload('merchantCost', {
          url: urlPrefix + 'silver-web-shop/merchantCost/getInfo',
          where: {
            page: 0,
            size: 0,
            merchantId: g_data.merchantId
          },
        });
      }
      // 添加商户计费信息
      var addIndex = null;
      $("#merchantCost_addBtn").click(function () {
        $("#merchantCost_add")
          .find("[name]")
          .val("");
        $("#serviceCharge_penVal").val("");
        $("#serviceCharge_rateVal").val("");
        $("#backCoverFee_val").val("");
        $("#backCoverFlag_li").show();
        $("#serviceCharge_rate,#backCoverFee_li,#serviceCharge_pen").hide();
        addIndex = layer.open({
          title: "添加商户计费信息",
          type: 1,
          skin: "layui-layer-rim", //加上边框
          area: ["460px", "351px"], //宽高
          content: $("#merchantCost_add")
        });
      });
      // 新增计费信息
      form.on('submit(add_merchantCost)', function (data) {
        if (data.field.tollType == "rate") {
          data.field.serviceCharge = accDiv(parseFloat(data.field.serviceCharge), 100);
        }
        data.field.merchantId = g_data.merchantId;
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantCost/insertInfo",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            if (response.status == 1) {
              layer.close(addIndex);
              layer.msg("添加成功");
              _reload();
            } else {
              layer.alert(response.msg);
            }
          }
        });
      });

      // 关闭新增弹窗
      $('.close_add').click(function () {
        layer.close(addIndex);
      })
      // 新增-选择收费类型
      form.on('select(tollType)', function (data) {
        if (data.value == "pen") {
          $("#serviceCharge_rate").hide();
          $("#serviceCharge_rate").find('input').removeAttr('lay-verify').removeAttr('name');
          $("#serviceCharge_penVal").val("");
          $("#serviceCharge_pen").show();
          $("#serviceCharge_pen").find('input').attr('lay-verify', 'required').attr('name', 'serviceCharge');

        } else if (data.value == "rate") {
          $("#serviceCharge_pen").hide();
          $("#serviceCharge_pen").find('input').removeAttr('lay-verify').removeAttr('name');
          $("#serviceCharge_rateVal").val("");
          $("#serviceCharge_rate").show();
          $("#serviceCharge_rate").find('input').attr('lay-verify', 'required').attr('name', 'serviceCharge');
        } else {
          $("#serviceCharge_pen,#serviceCharge_rate").removeAttr('lay-verify').removeAttr('name').hide();
        }
      });

      // 修改-选择收费类型
      form.on('select(tollType_update)', function (data) {
        if (data.value == "pen") {
          $("#serviceCharge_rate_update").hide();
          $("#serviceCharge_rate_update").find('input').removeAttr('lay-verify').removeAttr('name');
          $("#serviceCharge_penVal_update").val("");
          $("#serviceCharge_pen_update").show();
          $("#serviceCharge_pen_update").find('input').attr('lay-verify', 'required').attr('name', 'serviceCharge');

        } else if (data.value == "rate") {
          $("#serviceCharge_pen_update").hide();
          $("#serviceCharge_pen_update").find('input').removeAttr('lay-verify').removeAttr('name');
          $("#serviceCharge_rateVal_update").val("");
          $("#serviceCharge_rate_update").show();
          $("#serviceCharge_rate_update").find('input').attr('lay-verify', 'required').attr('name', 'serviceCharge');
        } else {
          $("#serviceCharge_pen_update,#serviceCharge_rate_update").removeAttr('lay-verify').removeAttr('name').hide();
        }
      });
      // 新增-选择是否封底
      form.on('select(backCoverFlag_val)', function (data) {
        if (data.value == "true") {
          $("#merchantCost_add [name=backCoverFee]").val("");
          $("#backCoverFee_li").show();
          $("#backCoverFee_li").find('input').attr('lay-verify', 'required');
        } else if (data.value == "false") {
          $("#backCoverFee_li").hide();
          $("#backCoverFee_li").find('input').removeAttr('lay-verify');
        } else {
          $("#backCoverFee_li").hide();
          $("#backCoverFee_li").find('input').removeAttr('lay-verify');
        }
      });
      // 修改-选择是否封底
      form.on('select(backCoverFlag_val_update)', function (data) {
        if (data.value == "true") {
          $("#merchantCost_update [name=backCoverFee]").val("");
          $("#backCoverFee_li_update").show();
          $("#backCoverFee_li_update").find('input').attr('lay-verify', 'required').attr('name', 'backCoverFee');
        } else if (data.value == "false") {
          $("#backCoverFee_li_update").hide();
          $("#backCoverFee_li_update").find('input').removeAttr('lay-verify').removeAttr('name');
        } else {
          $("#backCoverFee_li_update").hide();
          $("#backCoverFee_li_update").find('input').removeAttr('lay-verify').removeAttr('name');
        }
      });
      // 新增-选择费用类型
      form.on('select(costType)', function (data) {
        $("#serviceCharge_rate,#serviceCharge_pen").hide();
        $("#serviceCharge_rateVal,#serviceCharge_penVal,#backCoverFlag_val").val("");
        if (data.value == "paymentServiceCharge") {
          $("#tollType").html(
            '<option value="">请选择</option><option value="rate">比例</option>'
          );
          $("#backCoverFlag_li,#backCoverFee_li").hide();// 隐藏是否封底
          $("#backCoverFee_li").find('input').removeAttr('lay-verify').removeAttr('name');// 支付服务费没有封底手续费
          $("#backCoverFlag_li").find('select').removeAttr('lay-verify').removeAttr('name');// 支付服务费没有封底手续费
        } else {
          $("#tollType").html(
            '<option value="">请选择</option><option value="pen">每笔</option><option value="rate">比例</option>'
          );
          $("#backCoverFlag_val").find('input').attr('name', 'backCoverFlag').attr('lay-verify', 'required').val("");
          $("#backCoverFlag_li").show();
          $("#backCoverFlag_li").find('select').attr('name', 'backCoverFlag').attr('lay-verify', 'required');
        }
        form.render('select');
      });
      //监听工具条
      table.on('tool(merchantCost)', function (obj) {
        if (obj.event === 'edit') {// 修改
          var data = obj.data;
          if (data.backCoverFlag == '') {
            data.backCoverFlag = 'false';
          }
          if (data.costType == "paymentServiceCharge") {// 等于支付手续费时   
            $("#tollType_update").html('<option value="">请选择</option><option value="rate">比例</option>');
            $(
              "#backCoverFlag_li_update,#backCoverFee_li_update,#serviceCharge_pen_update"
            ).hide();// 按费率收费隐藏
            $("#serviceCharge_rate_update").show();// 支付手续费类型只有按费率收费
            $("#serviceCharge_rate_update").find('input').attr('lay-verify', 'required').attr('name', 'serviceCharge');// 为按费率收费添加name属性等于serviceCharge
            data.serviceCharge = accMul(data.serviceCharge, 100);

          } else {// 不等于支付手续费时

            $("#tollType_update").html(
              '<option value="">请选择</option><option value="pen">每笔</option><option value="rate">比例</option>'
            );
            $("#backCoverFlag_li_update").show();
            // 是否封底
            if (data.backCoverFlag == "true") {
              $("#backCoverFee_li_update").show();
              $("#backCoverFee_li_update").find('input').attr('lay-verify', 'required').attr('name', 'backCoverFee');
            } else {
              $("#backCoverFee_li_update").hide();
              $("#backCoverFee_li_update").find('input').removeAttr('name').removeAttr('lay-verify');
            }
            // 收费类型
            if (data.tollType == "pen") {
              $("#serviceCharge_rate_update").hide();
              $("#serviceCharge_rate_update").find('input').removeAttr('name').removeAttr('lay-verify');
              $("#serviceCharge_pen_update").show();
              $("#serviceCharge_pen_update").find('input').attr('lay-verify', 'required').attr('name', 'serviceCharge');// 为按费率
            } else {
              $("#serviceCharge_pen_update").hide();
              $("#serviceCharge_pen_update").find('input').removeAttr('name').removeAttr('lay-verify');
              $("#serviceCharge_rate_update").show();
              $("#serviceCharge_rate_update").find('input').attr('lay-verify', 'required').attr('name', 'serviceCharge');// 为按费率收费添加name属性等于serviceCharge
              data.serviceCharge = accMul(data.serviceCharge, 100)
            }
          }
          //表单初始赋值
          form.val('merchantCost_update', {
            "costType": data.costType
            , "tollType": data.tollType
            , "serialNo": data.serialNo
            , "backCoverFlag": data.backCoverFlag
            , "backCoverFee": data.backCoverFee
            , "serviceCharge": data.serviceCharge
          })
          form.render('select');

          addIndex = layer.open({
            type: 1,
            title: '修改商户计费信息',
            area: ["460px", "351px"], //宽高
            fixed: false, //不固定
            maxmin: true,
            content: $('#merchantCost_update')
          });
        }
      });
      // 修改计费信息
      form.on('submit(update_merchantCost)', function (data) {
        if (data.field.tollType == "rate") {
          data.field.serviceCharge = accDiv(parseFloat(data.field.serviceCharge), 100);
        }
        data.field.merchantId = g_data.merchantId;
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantCost/updateInfo",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            if (response.status == 1) {
              layer.close(addIndex);
              layer.msg("修改成功");
              _reload();
            } else {
              layer.alert(response.msg);
            }
          }
        });
      });

      //** 银行卡信息 **//
      $('#merchantBank_tab').click(function () {
        table.render({
          elem: '#merchantBank',
          cellMinWidth: 80,
          // height: tableHeight,
          url: urlPrefix + 'silver-web-shop/merchantBank/getInfo',
          method: 'post',
          cols: [
            [
              {
                field: 'defaultFlag', width: 80, title: '默认使用', templet: function (item) {
                  if (item.defaultFlag == '1') {
                    return '是';
                  } else if (item.defaultFlag == '2') {
                    return '否';
                  }
                }
              },
              {
                field: 'bankName', width: 100, title: '开户行名称'
              },
              {
                field: 'bankAccountNo', width: 100, title: '银行卡号'
              },
              {
                field: 'reservedTel', width: 100, title: '预留手机'
              },
              {
                field: 'bankName', width: 100, title: '开户行名称'
              },
              {
                field: 'bankAccountName', width: 120, title: '银行卡账户名称'
              },

              {
                field: 'bankProvince', width: 60, title: '省份'
              },
              {
                field: 'bankCity', width: 60, title: '市'
              },
              {
                field: 'bankAccountType', width: 130, title: '银行卡账户类型', templet: function (item) {
                  if (item.bankAccountType == 'personal') {
                    return '对私';
                  } else if (item.bankAccountType == 'corporate') {
                    return '对公';
                  }
                }
              }, {
                field: 'bankCardType', width: 100, title: '银行卡类别', templet: function (item) {
                  if (item.bankCardType == 'debit') {
                    return '借记卡';
                  } else if (item.bankCardType == 'credit') {
                    return '信用卡';
                  } else if (item.bankCardType == 'unit') {
                    return '单位结算卡';
                  }
                }
              }, {
                field: 'operate', title: '操作', toolbar: '#merchantBankTpl', fixed: 'right'
              }]
          ],
          event: true,
          response: {
            statusCode: 1 //重新规定成功的状态码为 200，table 组件默认为 0
          },
          where: {
            page: 0,
            size: 0,
            merchantId: g_data.merchantId
          },
          request: {
            pageName: 'page', //页码的参数名称，默认：page
            limitName: 'size' //每页数据量的参数名，默认：limit
          },
          parseData: function (res) { //将原始数据解析成 table 组件所规定的数据
            return {
              "code": res.status, //解析接口状态
              "msg": res.msg, //解析提示文本
              "count": res.totalCount, //解析数据长度
              "data": res.datas //解析数据列表
            };
          },
          done: function (res, curr, count) { }
        });

      })
      // 重载银行卡信息表格
      var _reloadBank = function () {
        table.reload('merchantBank', {
          url: urlPrefix + 'silver-web-shop/merchantBank/getInfo',
          where: {
            page: 0,
            size: 0,
            merchantId: g_data.merchantId
          },
        });
      }
      // 一级联动事件触发
      form.on('select(province)', function (data) {
        var value = data.value;
        areaState.province.fn(value, 'province', 'city');
      });
      form.on('select(province_update)', function (data) {
        var value = data.value;
        areaState.province.fn(value, 'province_update', 'city_update');
      });
      var areaState = {
        province: {
          state: false,
          data: [],
          fn: function (value, pId, Cid) { // value 表示的是区域代码，及传到后台的数据
            this.state = true; // 可能以后会用到
            var provinceCode = $('#' + id).find('[name=bankProvince]');

            if (value !== '') {
              //渲染城市select
              addSelect(Cid, getCity($('#' + pId).find('option:selected').attr('data-provincecode')), true, 'cityCode', 'cityName');
              // addCity('city', getCity($(provinceCode).find('option:selected').attr('data-provincecode')), true);
            } else {

              form.render("select");
            }
          }
        }
      };
      //select添加选项
      function addSelect(id, data, bool, code, name, defValue) {//bool是否添加“请选择”选项				
        var html = '';
        var $id = $('#' + id);
        $id.html('');
        if (bool) { html += '<option value="">请选择</option>'; }
        for (var key in data) {
          html += '<option data-provinceCode="' + data[key][code] + '" value="' + data[key][name] + '">' + data[key][name] + '</option>';
        }
        $id.html(html);
        $("#" + id).find("option[value='" + defValue + "']").prop("selected", true);
        form.render("select");
      }
      //获取省
      function getProvince() {
        var datas = null;
        $.ajax({
          url: urlPrefix + "silver-web-shop/provinceCityArea/findProvince",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          async: false,
          data: { page: 0, size: 0 },
          success: function (response) {
            if (response.status == 1) {
              datas = response.datas;
            } else {
              layer.alert(response.msg);
            }
          }
        });
        //倒叙排序
        return datas.reverse();
      }
      //获取城市
      function getCity(code) {
        var datas = null;
        var data = { provinceCode: code, page: 0, size: 0 };
        $.ajax({
          url: urlPrefix + "silver-web-shop/provinceCityArea/findCity",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          async: false,
          data: data,
          success: function (response) {
            if (response.status == 1) {
              datas = response.datas;
            } else {
              layer.alert(response.msg);
            }
          }
        });
        //倒叙排序
        return datas.reverse();
      }
      // 添加商户银行卡信息
      var addIndexBank = null;
      $("#merchantBank_addBtn").click(function () {
        addSelect('province', getProvince(), true, 'provinceCode', 'provinceName');// 添加银行卡时渲染省份  
        $("#merchantBank_add").find("[name]").val("");// 初始化内容    
        form.render('select');
        addIndexBank = layer.open({
          title: "添加商户银行卡信息",
          type: 1,
          skin: "layui-layer-rim", //加上边框
          area: ["694px", "500px"], //宽高
          content: $("#merchantBank_add")
        });
      });

      // 新增商户银行卡信息
      form.on('submit(add_merchantBankBtn)', function (data) {
        data.field.merchantId = g_data.merchantId;
        if (data.field.defaultFlag == '') {
          data.field.defaultFlag = 1;
        } else {
          data.field.defaultFlag = 2;
        }
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantBank/managerInsert",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            if (response.status == 1) {
              layer.close(addIndexBank);
              layer.msg("添加成功");
              _reloadBank();
            } else {
              layer.alert(response.msg);
            }
          }
        });
      });
      // 关闭新增弹窗
      $('#merchantBank_add .close_add').click(function () {
        layer.close(addIndexBank);
      })
      //监听工具条
      table.on('tool(merchantBank)', function (obj) {
        if (obj.event === 'edit') {// 修改
          var data = obj.data;
          addSelect('province_update', getProvince(), true, 'provinceCode', 'provinceName', data.bankProvince);// 修改银行卡时渲染省份  
          addSelect('city_update', getCity($('#province_update').find('option:selected').attr('data-provincecode')), true, 'cityCode', 'cityName', data.bankCity);
          //表单初始赋值
          form.val('merchantBank_update', {
            "bankAccountName": data.bankAccountName
            , "defaultFlag": data.defaultFlag
            , "bankAccountNo": data.bankAccountNo
            , "bankAccountType": data.bankAccountType
            , "bankCardType": data.bankCardType
            , "bankName": data.bankName
            , "bankShortName": data.bankShortName
            , "merchantId": data.merchantId
            , "reservedTel": data.reservedTel
            , "serialNo": data.serialNo
          })
          form.render('select');

          addIndexBank = layer.open({
            type: 1,
            title: '修改银行卡信息',
            area: ["694px", "500px"], //宽高
            fixed: false, //不固定
            maxmin: true,
            content: $('#merchantBank_update')
          });
        }
      });
      // 修改银行卡信息信息
      form.on('submit(update_merchantBankBtn)', function (data) {
        if (data.field.tollType == "rate") {
          data.field.serviceCharge = accDiv(parseFloat(data.field.serviceCharge), 100);
        }
        if (data.field.defaultFlag == 'on') {
          data.field.defaultFlag = 1;
        } else {
          data.field.defaultFlag = 2;
        }
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantBank/managerUpdate",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            if (response.status == 1) {
              layer.close(addIndexBank);
              layer.msg("修改成功");
              _reloadBank();
            } else {
              layer.alert(response.msg);
            }
          }
        });
      });

      /** 口岸信息 **/
      var CustomsPortArr = [];// 全局海关信息
      // 查询海关信息
      var _queryCustomsPort = function (id) {
        $.ajax({
          url: urlPrefix + "silver-web-shop/customsPort/findAllCustomsPort",
          type: "POST",
          async: false,
          success: function (response) {
            if (response.status == 1) {
              CustomsPortArr = response.datas;
              var ciqOrgHtml = '<option value="">请选择</option>';
              $.each(CustomsPortArr, function (i, item) {
                ciqOrgHtml +=
                  '<option value="' +
                  item.customsPort + '' +
                  "-" +
                  item.customsPortName +
                  "-" +
                  item.customsCode + '' +
                  "-" +
                  item.customsName +
                  "-" +
                  item.ciqOrgCode + '' +
                  "-" +
                  item.ciqOrgName +
                  '">' +
                  item.customsPort +
                  "-" +
                  item.customsPortName +
                  " / " +
                  item.customsCode +
                  "-" +
                  item.customsName +
                  " / " +
                  item.ciqOrgCode +
                  "-" +
                  item.ciqOrgName +
                  "</option>";
              });
              $('#' + id).find('[name=ciqOrg]').html(ciqOrgHtml);
              form.render('select');
            }
          }
        });
      };
      // 查询口岸信息
      $('#portRate_tab').click(function () {
        table.render({
          elem: '#portRate',
          cellMinWidth: 80,
          // height: tableHeight,
          url: urlPrefix + 'silver-web-shop/merchantFee/getServiceFee',
          method: 'post',
          cols: [
            [
              {
                field: 'customsPortName', width: 100, title: '口岸', templet: function (item) {
                  return item.customsPort + '-' + item.customsPortName;
                }
              },
              {
                field: 'customsName', width: 140, title: '主管海关', templet: function (item) {
                  return item.customsCode + '-' + item.customsName;
                }
              },
              {
                field: 'ciqOrgName', width: 160, title: '检验检疫机构', templet: function (item) {
                  return item.ciqOrgCode + '-' + item.ciqOrgName;
                }
              },
              {
                field: 'type', width: 130, title: '类型', templet: function (item) {
                  if (item.type == 'goodsRecord') {
                    return '商品备案';
                  } else if (item.type == 'orderRecord') {
                    return '订单备案';
                  } else if (item.type == 'paymentRecord') {
                    return '支付单备案';
                  }
                }
              },
              {
                field: 'status', width: 80, title: '状态', templet: function (item) {
                  if (item.status == '1') {
                    return '正常';
                  } else if (item.status == '2') {
                    return '禁用';
                  }
                }
              },
              {
                field: 'operate', title: '操作', toolbar: '#merchantBankTpl', fixed: 'right'
              }]
          ],
          event: true,
          response: {
            statusCode: 1 //重新规定成功的状态码为 200，table 组件默认为 0
          },
          where: {
            page: 0,
            size: 0,
            merchantId: g_data.merchantId
          },
          request: {
            pageName: 'page', //页码的参数名称，默认：page
            limitName: 'size' //每页数据量的参数名，默认：limit
          },
          parseData: function (res) { //将原始数据解析成 table 组件所规定的数据
            return {
              "code": res.status, //解析接口状态
              "msg": res.msg, //解析提示文本
              "count": res.totalCount, //解析数据长度
              "data": res.datas //解析数据列表
            };
          },
          done: function (res, curr, count) { }
        });

      })
      // 重载口岸信息
      var _reload_portRate = function () {
        table.reload('portRate', {
          url: urlPrefix + 'silver-web-shop/merchantFee/getServiceFee',
          where: {
            page: 0,
            size: 0,
            merchantId: g_data.merchantId
          },
        });
      }
      // 添加口岸信息
      var addIndex_portRate = null;
      $("#portRate_addBtn").click(function () {
        _queryCustomsPort('portRate_add');
        $("#portRate_add").find("[name]").val("");// 初始化内容    
        form.render('select');
        addIndex_portRate = layer.open({
          title: "添加商户口岸信息",
          type: 1,
          skin: "layui-layer-rim", //加上边框
          area: ["715px", "299px"], //宽高
          content: $("#portRate_add")
        });
      });
      // 新增口岸信息
      form.on('submit(portRate_updateBtn)', function (data) {
        data.field.merchantId = g_data.merchantId;
        data.field.tollType = 'pen';
        data.field.penFees = 0;
        data.field.customsPort = data.field.ciqOrg.split('-')[0];
        data.field.customsPortName = data.field.ciqOrg.split('-')[1];
        data.field.customsCode = data.field.ciqOrg.split('-')[2];
        data.field.customsName = data.field.ciqOrg.split('-')[3];
        data.field.ciqOrgCode = data.field.ciqOrg.split('-')[4];
        data.field.ciqOrgName = data.field.ciqOrg.split('-')[5];
        // console.log(data.field)
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantFee/addServiceFee",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            if (response.status == 1) {
              layer.close(addIndex_portRate);
              layer.msg("添加成功");
              _reload_portRate();
            } else {
              layer.alert(response.msg);
            }
          }
        });
      });
      //监听工具条
      table.on('tool(portRate)', function (obj) {
        if (obj.event === 'edit') {// 修改
          _queryCustomsPort('portRate_update');
          var data = obj.data;
          //表单初始赋值
          form.val('portRate_update', {
            "type": data.type
            , "status": data.status
            , "merchantId": data.merchantId
            , "merchantFeeId": data.merchantFeeId
            , "tollType": 'pen'
            , "penFees": 0
            , "ciqOrg": data.customsPort + '-' + data.customsPortName + '-' + data.customsCode + '-' + data.customsName + '-' + data.ciqOrgCode + '-' + data.ciqOrgName

          })
          form.render('select');

          addIndex_portRate = layer.open({
            type: 1,
            title: '修改商户口岸信息',
            area: ["730px", "299px"], //宽高
            fixed: false, //不固定
            maxmin: true,
            content: $('#portRate_update')
          });
        }
      });
      // 修改商户口岸信息
      form.on('submit(update_portRateBtn)', function (data) {
        data.field.customsPort = data.field.ciqOrg.split('-')[0];
        data.field.customsPortName = data.field.ciqOrg.split('-')[1];
        data.field.customsCode = data.field.ciqOrg.split('-')[2];
        data.field.customsName = data.field.ciqOrg.split('-')[3];
        data.field.ciqOrgCode = data.field.ciqOrg.split('-')[4];
        data.field.ciqOrgName = data.field.ciqOrg.split('-')[5];
        $.ajax({
          url: urlPrefix + "silver-web-shop/merchantFee/updateServiceFee",
          type: "POST",
          xhrFields: {
            withCredentials: true
          },
          data: data.field,
          success: function (response) {
            if (response.status == 1) {
              layer.close(addIndex_portRate);
              layer.msg("修改成功");
              _reload_portRate();
            } else {

              layer.alert(response.msg);
            }
          }
        });
      });

    });

  </script>
</body>

</html>